<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Gtag Test</title>
    <script src="https://aframe.io"></script>
    <!-- Joystick Library -->
    <script src="https://cdnjs.cloudflare.com"></script>
    <style>
      #joystick-container { position: absolute; bottom: 0; left: 0; width: 100%; height: 40%; z-index: 10; pointer-events: none; }
      .zone { position: absolute; width: 33%; height: 100%; pointer-events: auto; }
      #zone-left { left: 0; }
      #zone-right { right: 0; }
      #zone-look { left: 33%; }
    </style>
  </head>
  <body>
    <!-- 3 Joystick Zones -->
    <div id="joystick-container">
      <div id="zone-left" class="zone"></div>
      <div id="zone-look" class="zone"></div>
      <div id="zone-right" class="zone"></div>
    </div>

    <a-scene background="color: #111">
      <a-plane position="0 0 0" rotation="-90 0 0" width="100" height="100" color="#222"></a-plane>
      
      
        <a-camera id="cam" look-controls="enabled: false">
          
          
        </a-camera>
      
    </a-scene>

    <script>
      const rig = document.querySelector('#rig');
      const cam = document.querySelector('#cam');

      // Create 3 Joysticks
      const options = (zone) => ({ zone: document.getElementById(zone), mode: 'static', position: {left: '50%', bottom: '50%'}, color: 'white' });
      const joyL = nipplejs.create(options('zone-left'));
      const joyR = nipplejs.create(options('zone-right'));
      const joyLook = nipplejs.create(options('zone-look'));

      // Look Logic (Center Joystick)
      joyLook.on('move', (evt, data) => {
        const rot = cam.getAttribute('rotation');
        cam.setAttribute('rotation', { x: rot.x + data.vector.y * 2, y: rot.y - data.vector.x * 2, z: 0 });
      });

      // Movement Logic (Left/Right Arms)
      const move = (data) => {
        const angle = cam.getAttribute('rotation').y * (Math.PI / 180);
        const x = data.vector.x * Math.cos(angle) + data.vector.y * Math.sin(angle);
        const z = data.vector.x * Math.sin(angle) - data.vector.y * Math.cos(angle);
        rig.object3D.position.x += x * 0.1;
        rig.object3D.position.z += z * 0.1;
      };

      joyL.on('move', (evt, data) => move(data));
      joyR.on('move', (evt, data) => move(data));
    </script>
  </body>
</html>
